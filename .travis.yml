---
services: docker

env:
  - repo=$DOCKERHUB_USERNAME/docker-centos7-ansible

before_install:
  - export container_id=$(date +%s)
  - export cleanup=false
  - export init="/usr/lib/systemd/systemd"
  - export opts="--privileged --volume=/sys/fs/cgroup:/sys/fs/cgroup:ro"
  - playbook="test.yml"
  
script:
  # Download image
  - docker pull $repo
  
  # Run container
  - docker run -d -v="$PWD":/etc/ansible/roles/role_to_test:rw --name $container_id $opts $repo $init
